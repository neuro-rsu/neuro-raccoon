<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Crazy Raccoon</title>
    <script type="module">
        // let a = new Blob(["<html><head> <meta charset='utf-8'></head>Мой</html>"], {type: "text/html"});
        // //let a = new Blob(["Мой"], {type: "text/plant"});
        // let dataReader = new Promise( (resolve, reject) => {
        //     let reader = new FileReader();
        //     reader.onload = () => {
        //         resolve(reader.result)
        //     }
        //     reader.onerror = (error) => reject(error);
        //     reader.readAsDataURL(a);
        // })

        // let data = await dataReader;
        // let link = document.createElement('a');
        // // link.href = URL.createObjectURL(a);


        // link.href = data;
        // link.target = "_blank";
        // //link.click = () => debugBase64(data);
        // link.textContent = "My Link";
        // document.body.append(link);
        // debugBase64(data);

        // function debugBase64(base64URL){
        //     var win = window.open();
        //     win.document.write('<iframe src="' + base64URL  + '" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>');
        // }

        let link = document.createElement('a');
link.download = 'hello.txt';
link.text = "My Link";
document.body.append(link);

let blob = new Blob(['Hello, world!'], {type: 'text/plain'});

let reader = new FileReader();

reader.readAsDataURL(blob); // конвертирует Blob в base64 и вызывает onload

reader.onload = function() {
  link.href = reader.result; // url с данными
  //link.click();
};

function readFile(input) {
  let file = input.files[0];
  let reader = new FileReader();
  reader.readAsText(file);
  reader.onload = function() {
    console.log(reader.result);
  };

  reader.onerror = function() {
    console.log(reader.error);
  };
}
    </script>
</head>

<body>
    <script>
        function readFile(input) {
  let file = input.files[0];
  let reader = new FileReader();
  reader.readAsText(file);
  reader.onload = function() {
    console.log(reader.result);
  };

  reader.onerror = function() {
    console.log(reader.error);
  };
}
    </script>
    <img src="data:image/png;base64,R0lGODlhDAAMAKIFAF5LAP/zxAAAANyuAP/gaP///wAAAAAAACH5BAEAAAUALAAAAAAMAAwAAAMlWLPcGjDKFYi9lxKBOaGcF35DhWHamZUW0K4mAbiwWtuf0uxFAgA7">
    <input type="file" onchange="readFile(this)">
</body>

</html>